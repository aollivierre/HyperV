
DC Health Check (DCDiag):
 Directory Server Diagnosis   Performing initial setup:     Trying to find home server...     * Verifying that the local machine DC2, is a Directory Server.     Home Server = DC2     * Connecting to directory service on server DC2.     * Identified AD Forest.     Collecting AD specific global data     * Collecting site info.     Calling ldap_search_init_page(hld,CN=Sites,CN=Configuration,DC=abc,DC=local,LDAP_SCOPE_SUBTREE,(objectCategory=ntDSSiteSettings),.......    The previous call succeeded     Iterating through the sites     Looking at base site object: CN=NTDS Site Settings,CN=Default-First-Site-Name,CN=Sites,CN=Configuration,DC=abc,DC=local    Getting ISTG and options for the site    * Identifying all servers.     Calling ldap_search_init_page(hld,CN=Sites,CN=Configuration,DC=abc,DC=local,LDAP_SCOPE_SUBTREE,(objectClass=ntDSDsa),.......    The previous call succeeded....    The previous call succeeded    Iterating through the list of servers     Getting information for the server CN=NTDS Settings,CN=DC1,CN=Servers,CN=Default-First-Site-Name,CN=Sites,CN=Configuration,DC=abc,DC=local     objectGuid obtained    InvocationID obtained    dnsHostname obtained    site info obtained    All the info for the server collected    Getting information for the server CN=NTDS Settings,CN=DC2,CN=Servers,CN=Default-First-Site-Name,CN=Sites,CN=Configuration,DC=abc,DC=local     objectGuid obtained    InvocationID obtained    dnsHostname obtained    site info obtained    All the info for the server collected    * Identifying all NC cross-refs.     * Found 2 DC(s). Testing 1 of them.     Done gathering initial info.   Doing initial required tests         Testing server: Default-First-Site-Name\DC2        Starting test: Connectivity           * Active Directory LDAP Services Check          Determining IP4 connectivity           * Active Directory RPC Services Check          ......................... DC2 passed test Connectivity    Doing primary tests         Testing server: Default-First-Site-Name\DC2        Starting test: Advertising           The DC DC2 is advertising itself as a DC and having a DS.          The DC DC2 is advertising as an LDAP server          The DC DC2 is advertising as having a writeable directory          The DC DC2 is advertising as a Key Distribution Center          The DC DC2 is advertising as a time server          The DS DC2 is advertising as a GC.          ......................... DC2 passed test Advertising        Test omitted by user request: CheckSecurityError        Test omitted by user request: CutoffServers        Starting test: FrsEvent           * The File Replication Service Event log test           Skip the test because the server is running DFSR.           ......................... DC2 passed test FrsEvent        Starting test: DFSREvent           The DFS Replication Event Log.           There are warning or error events within the last 24 hours after the           SYSVOL has been shared.  Failing SYSVOL replication problems may cause           Group Policy problems.           An error event occurred.  EventID: 0xC00017D8              Time Generated: 11/11/2024   09:44:15              Event String:              The DFS Replication service failed to register the WMI providers. Replication is disabled until the problem is resolved.                              Additional Information:               Error: 2147749902 (100e)           A warning event occurred.  EventID: 0x80001780              Time Generated: 11/11/2024   10:16:04              Event String:              The DFS Replication service failed to update configuration in Active Directory Domain Services. The service will retry this operation periodically.                              Additional Information:               Object Category: msDFSR-LocalSettings               Object DN: CN=DFSR-LocalSettings,CN=DC2,OU=Domain Controllers,DC=abc,DC=local               Error: 2 (The system cannot find the file specified.)               Domain Controller: dc1.abc.local               Polling Cycle: 60           A warning event occurred.  EventID: 0x80001A94              Time Generated: 11/11/2024   10:16:04              Event String:              The DFS Replication service has detected that no connections are configured for replication group Domain System Volume. No data is being replicated for this replication group.                              Additional Information:               Replication Group ID: AFCB191A-E6F1-4198-A9BD-334D8951D4D6               Member ID: 1FF76011-7965-49F6-BD4A-03D8D0583CF3           A warning event occurred.  EventID: 0x80001206              Time Generated: 11/11/2024   10:16:04              Event String:              The DFS Replication service initialized SYSVOL at local path C:\Windows\SYSVOL\domain and is waiting to perform initial replication. The replicated folder will remain in the initial synchronization state until it has replicated with its partner DC1.abc.local. If the server was in the process of being promoted to a domain controller, the domain controller will not advertize and function as a domain controller until this issue is resolved. This can occur if the specified partner is also in the initial synchronization state, or if sharing violations are encountered on this server or the synchronization partner. If this event occurred during the migration of SYSVOL from File Replication service (FRS) to DFS Replication, changes will not replicate out until this issue is resolved. This can cause the SYSVOL folder on this server to become out of sync with other domain controllers.                              Additional Information:               Replicated Folder Name: SYSVOL Share               Replicated Folder ID: E6FE2FC5-6122-4BB4-85AE-E602C27CC066               Replication Group Name: Domain System Volume               Replication Group ID: AFCB191A-E6F1-4198-A9BD-334D8951D4D6               Member ID: 1FF76011-7965-49F6-BD4A-03D8D0583CF3               Read-Only: 0           ......................... DC2 failed test DFSREvent        Starting test: SysVolCheck           * The File Replication Service SYSVOL ready test           File Replication Service's SYSVOL is ready           ......................... DC2 passed test SysVolCheck        Starting test: KccEvent           * The KCC Event log test          Found no KCC errors in "Directory Service" Event log in the last 15 minutes.          ......................... DC2 passed test KccEvent        Starting test: KnowsOfRoleHolders           Role Schema Owner = CN=NTDS Settings,CN=DC1,CN=Servers,CN=Default-First-Site-Name,CN=Sites,CN=Configuration,DC=abc,DC=local          Role Domain Owner = CN=NTDS Settings,CN=DC1,CN=Servers,CN=Default-First-Site-Name,CN=Sites,CN=Configuration,DC=abc,DC=local          Role PDC Owner = CN=NTDS Settings,CN=DC1,CN=Servers,CN=Default-First-Site-Name,CN=Sites,CN=Configuration,DC=abc,DC=local          Role Rid Owner = CN=NTDS Settings,CN=DC1,CN=Servers,CN=Default-First-Site-Name,CN=Sites,CN=Configuration,DC=abc,DC=local          Role Infrastructure Update Owner = CN=NTDS Settings,CN=DC1,CN=Servers,CN=Default-First-Site-Name,CN=Sites,CN=Configuration,DC=abc,DC=local          ......................... DC2 passed test KnowsOfRoleHolders        Starting test: MachineAccount           Checking machine account for DC DC2 on DC DC2.          * SPN found :LDAP/DC2.abc.local/abc.local          * SPN found :LDAP/DC2.abc.local          * SPN found :LDAP/DC2          * SPN found :LDAP/DC2.abc.local/ABC          * SPN found :LDAP/8b786dd3-d770-4591-8719-118f31e7fe3b._msdcs.abc.local          * SPN found :E3514235-4B06-11D1-AB04-00C04FC2DCD2/8b786dd3-d770-4591-8719-118f31e7fe3b/abc.local          * SPN found :HOST/DC2.abc.local/abc.local          * SPN found :HOST/DC2.abc.local          * SPN found :HOST/DC2          * SPN found :HOST/DC2.abc.local/ABC          * SPN found :GC/DC2.abc.local/abc.local          ......................... DC2 passed test MachineAccount        Starting test: NCSecDesc           * Security Permissions check for all NC's on DC DC2.          * Security Permissions Check for             DC=ForestDnsZones,DC=abc,DC=local             (NDNC,Version 3)          * Security Permissions Check for             DC=DomainDnsZones,DC=abc,DC=local             (NDNC,Version 3)          * Security Permissions Check for             CN=Schema,CN=Configuration,DC=abc,DC=local             (Schema,Version 3)          * Security Permissions Check for             CN=Configuration,DC=abc,DC=local             (Configuration,Version 3)          * Security Permissions Check for             DC=abc,DC=local             (Domain,Version 3)          ......................... DC2 passed test NCSecDesc        Starting test: NetLogons           * Network Logons Privileges Check          Verified share \\DC2\netlogon          Verified share \\DC2\sysvol          ......................... DC2 passed test NetLogons        Starting test: ObjectsReplicated           DC2 is in domain DC=abc,DC=local          Checking for CN=DC2,OU=Domain Controllers,DC=abc,DC=local in domain DC=abc,DC=local on 1 servers             Object is up-to-date on all servers.          Checking for CN=NTDS Settings,CN=DC2,CN=Servers,CN=Default-First-Site-Name,CN=Sites,CN=Configuration,DC=abc,DC=local in domain CN=Configuration,DC=abc,DC=local on 1 servers             Object is up-to-date on all servers.          ......................... DC2 passed test ObjectsReplicated        Test omitted by user request: OutboundSecureChannels        Starting test: Replications           * Replications Check          * Replication Latency Check          ......................... DC2 passed test Replications        Starting test: RidManager           * Available RID Pool for the Domain is 2100 to 1073741823          * DC1.abc.local is the RID Master          * DsBind with RID Master was successful          * rIDAllocationPool is 1600 to 2099          * rIDPreviousAllocationPool is 1600 to 2099          * rIDNextRID: 1600          ......................... DC2 passed test RidManager        Starting test: Services           * Checking Service: EventSystem          * Checking Service: RpcSs          * Checking Service: NTDS          * Checking Service: DnsCache          * Checking Service: DFSR          * Checking Service: IsmServ          * Checking Service: kdc          * Checking Service: SamSs          * Checking Service: LanmanServer          * Checking Service: LanmanWorkstation          * Checking Service: w32time          * Checking Service: NETLOGON          ......................... DC2 passed test Services        Starting test: SystemLog           * The System Event log test          A warning event occurred.  EventID: 0x000727A5              Time Generated: 11/11/2024   09:35:53              Event String:              The WinRM service is not listening for WS-Management requests.                              User Action                If you did not intentionally stop the service, use the following command to see the WinRM configuration:                              winrm enumerate winrm/config/listener           A warning event occurred.  EventID: 0x000727AA              Time Generated: 11/11/2024   09:35:57              Event String:              The WinRM service failed to create the following SPNs: WSMAN/DC2.abc.local; WSMAN/DC2.                              Additional Data                The error received was 1355: %%1355.                             User Action                The SPNs can be created by an administrator using setspn.exe utility.           A warning event occurred.  EventID: 0x00001796              Time Generated: 11/11/2024   09:43:52              Event String:              Microsoft Windows Server has detected that NTLM authentication is presently being used between clients and this server. This event occurs once per boot of the server on the first time a client uses NTLM with this server.                             NTLM is a weaker authentication mechanism. Please check:                                   Which applications are using NTLM authentication?                    Are there configuration issues preventing the use of stronger authentication such as Kerberos authentication?                    If NTLM must be supported, is Extended Protection configured?                             Details on how to complete these checks can be found at http://go.microsoft.com/fwlink/?LinkId=225699.           A warning event occurred.  EventID: 0x80040020              Time Generated: 11/11/2024   10:15:14              Event String:              The driver detected that the device \Device\Harddisk0\DR0 has its write cache enabled. Data corruption may occur.           A warning event occurred.  EventID: 0x80040020              Time Generated: 11/11/2024   10:15:14              Event String:              The driver detected that the device \Device\Harddisk0\DR0 has its write cache enabled. Data corruption may occur.           A warning event occurred.  EventID: 0x80040020              Time Generated: 11/11/2024   10:15:14              Event String:              The driver detected that the device \Device\Harddisk0\DR0 has its write cache enabled. Data corruption may occur.           A warning event occurred.  EventID: 0x000727A5              Time Generated: 11/11/2024   10:15:37              Event String:              The WinRM service is not listening for WS-Management requests.                              User Action                If you did not intentionally stop the service, use the following command to see the WinRM configuration:                              winrm enumerate winrm/config/listener           A warning event occurred.  EventID: 0x80040020              Time Generated: 11/11/2024   10:15:40              Event String:              The driver detected that the device \Device\Harddisk0\DR0 has its write cache enabled. Data corruption may occur.           A warning event occurred.  EventID: 0x80040020              Time Generated: 11/11/2024   10:15:40              Event String:              The driver detected that the device \Device\Harddisk0\DR0 has its write cache enabled. Data corruption may occur.           A warning event occurred.  EventID: 0x80040020              Time Generated: 11/11/2024   10:15:40              Event String:              The driver detected that the device \Device\Harddisk0\DR0 has its write cache enabled. Data corruption may occur.           A warning event occurred.  EventID: 0x000003F6              Time Generated: 11/11/2024   10:15:43              Event String:              Name resolution for the name _ldap._tcp.dc._msdcs.abc.local. timed out after none of the configured DNS servers responded.           ......................... DC2 failed test SystemLog        Test omitted by user request: Topology        Test omitted by user request: VerifyEnterpriseReferences        Starting test: VerifyReferences           The system object reference (serverReference)           CN=DC2,OU=Domain Controllers,DC=abc,DC=local and backlink on           CN=DC2,CN=Servers,CN=Default-First-Site-Name,CN=Sites,CN=Configuration,DC=abc,DC=local           are correct.           The system object reference (serverReferenceBL)           CN=DC2,CN=Topology,CN=Domain System Volume,CN=DFSR-GlobalSettings,CN=System,DC=abc,DC=local           and backlink on           CN=NTDS Settings,CN=DC2,CN=Servers,CN=Default-First-Site-Name,CN=Sites,CN=Configuration,DC=abc,DC=local           are correct.           The system object reference (msDFSR-ComputerReferenceBL)           CN=DC2,CN=Topology,CN=Domain System Volume,CN=DFSR-GlobalSettings,CN=System,DC=abc,DC=local           and backlink on CN=DC2,OU=Domain Controllers,DC=abc,DC=local are           correct.           ......................... DC2 passed test VerifyReferences        Test omitted by user request: VerifyReplicas            Test omitted by user request: DNS        Test omitted by user request: DNS         Running partition tests on : ForestDnsZones        Starting test: CheckSDRefDom           ......................... ForestDnsZones passed test CheckSDRefDom        Starting test: CrossRefValidation           ......................... ForestDnsZones passed test           CrossRefValidation         Running partition tests on : DomainDnsZones        Starting test: CheckSDRefDom           ......................... DomainDnsZones passed test CheckSDRefDom        Starting test: CrossRefValidation           ......................... DomainDnsZones passed test           CrossRefValidation         Running partition tests on : Schema        Starting test: CheckSDRefDom           ......................... Schema passed test CheckSDRefDom        Starting test: CrossRefValidation           ......................... Schema passed test CrossRefValidation         Running partition tests on : Configuration        Starting test: CheckSDRefDom           ......................... Configuration passed test CheckSDRefDom        Starting test: CrossRefValidation           ......................... Configuration passed test CrossRefValidation         Running partition tests on : abc        Starting test: CheckSDRefDom           ......................... abc passed test CheckSDRefDom        Starting test: CrossRefValidation           ......................... abc passed test CrossRefValidation         Running enterprise tests on : abc.local        Test omitted by user request: DNS        Test omitted by user request: DNS        Starting test: LocatorCheck           GC Name: \\DC2.abc.local           Locator Flags: 0xe003f1fc          PDC Name: \\DC1.abc.local          Locator Flags: 0xe003f1fd          Time Server Name: \\DC2.abc.local          Locator Flags: 0xe003f1fc          Preferred Time Server Name: \\DC2.abc.local          Locator Flags: 0xe003f1fc          KDC Name: \\DC2.abc.local          Locator Flags: 0xe003f1fc          ......................... abc.local passed test LocatorCheck        Starting test: Intersite           Skipping site Default-First-Site-Name, this site is outside the scope           provided by the command line arguments provided.           ......................... abc.local passed test Intersite 

Replication Status:
  Repadmin: running command /showrepl against full DC localhost  Default-First-Site-Name\DC2  DSA Options: IS_GC   Site Options: (none)  DSA object GUID: 8b786dd3-d770-4591-8719-118f31e7fe3b  DSA invocationID: 374a82bc-259d-4a31-8bb0-73f3d3e87449    ==== INBOUND NEIGHBORS ======================================    DC=abc,DC=local      Default-First-Site-Name\DC1 via RPC          DSA object GUID: 0d3e9a8e-4bdd-495a-8efe-d370ce526008          Last attempt @ 2024-11-11 10:30:12 was successful.    CN=Configuration,DC=abc,DC=local      Default-First-Site-Name\DC1 via RPC          DSA object GUID: 0d3e9a8e-4bdd-495a-8efe-d370ce526008          Last attempt @ 2024-11-11 10:21:23 was successful.    CN=Schema,CN=Configuration,DC=abc,DC=local      Default-First-Site-Name\DC1 via RPC          DSA object GUID: 0d3e9a8e-4bdd-495a-8efe-d370ce526008          Last attempt @ 2024-11-11 10:16:24 was successful.    DC=DomainDnsZones,DC=abc,DC=local      Default-First-Site-Name\DC1 via RPC          DSA object GUID: 0d3e9a8e-4bdd-495a-8efe-d370ce526008          Last attempt @ 2024-11-11 10:19:12 was successful.    DC=ForestDnsZones,DC=abc,DC=local      Default-First-Site-Name\DC1 via RPC          DSA object GUID: 0d3e9a8e-4bdd-495a-8efe-d370ce526008          Last attempt @ 2024-11-11 10:19:09 was successful.   

FSMO Roles:
Schema master               DC1.abc.local Domain naming master        DC1.abc.local PDC                         DC1.abc.local RID pool manager            DC1.abc.local Infrastructure master       DC1.abc.local The command completed successfully. 
